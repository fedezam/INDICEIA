<div class="stat-change positive">
                                    <i class="fas fa-star"></i> Excelente
                                </div>
                            </div>
                        </div>

                        <div style="background: white; padding: 32px; border-radius: 16px; border: 1px solid var(--gray-200); margin-top: 32px;">
                            <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-chart-bar" style="color: var(--primary);"></i> 
                                Próximamente
                            </h3>
                            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                                <div style="padding: 20px; background: var(--gray-50); border-radius: 12px;">
                                    <h4 style="color: var(--primary); margin-bottom: 12px;">
                                        <i class="fas fa-chart-line"></i> Gráficos Detallados
                                    </h4>
                                    <ul style="margin: 0; padding-left: 20px; color: var(--gray-600); font-size: 14px;">
                                        <li>Consultas por día/hora</li>
                                        <li>Picos de actividad</li>
                                        <li>Tendencias mensuales</li>
                                    </ul>
                                </div>
                                <div style="padding: 20px; background: var(--gray-50); border-radius: 12px;">
                                    <h4 style="color: var(--success); margin-bottom: 12px;">
                                        <i class="fas fa-bullseye"></i> Análisis de Productos
                                    </h4>
                                    <ul style="margin: 0; padding-left: 20px; color: var(--gray-600); font-size: 14px;">
                                        <li>Productos más consultados</li>
                                        <li>Conversiones por categoria</li>
                                        <li>Oportunidades de venta</li>
                                    </ul>
                                </div>
                                <div style="padding: 20px; background: var(--gray-50); border-radius: 12px;">
                                    <h4 style="color: var(--warning); margin-bottom: 12px;">
                                        <i class="fas fa-brain"></i> IA Inteligente
                                    </h4>
                                    <ul style="margin: 0; padding-left: 20px; color: var(--gray-600); font-size: 14px;">
                                        <li>Sugerencias automáticas</li>
                                        <li>Optimización de respuestas</li>
                                        <li>Reportes semanales</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js';
        import { getFirestore, doc, setDoc, getDoc, collection, addDoc } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js';

        // Firebase config (replace with your actual config)
        const firebaseConfig = {
            apiKey: "your-api-key",
            authDomain: "your-project.firebaseapp.com", 
            projectId: "your-project-id",
            storageBucket: "your-project.appspot.com",
            messagingSenderId: "123456789",
            appId: "your-app-id"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Global variables
        let currentUser = null;
        let currentPlan = 'extended';
        let productos = [];
        let servicios = [];
        let categorias = ['General'];

        // Utility functions
        class Utils {
            static showLoading(text = 'Cargando...') {
                const overlay = document.getElementById('loadingOverlay');
                const loadingText = document.getElementById('loadingText');
                loadingText.textContent = text;
                overlay.classList.add('show');
            }

            static hideLoading() {
                document.getElementById('loadingOverlay').classList.remove('show');
            }

            static showToast(title, message, type = 'success') {
                const container = document.getElementById('toastContainer');
                const toast = document.createElement('div');
                
                const icons = {
                    success: 'fas fa-check-circle',
                    error: 'fas fa-exclamation-circle', 
                    warning: 'fas fa-exclamation-triangle',
                    info: 'fas fa-info-circle'
                };

                toast.className = `toast ${type}`;
                toast.innerHTML = `
                    <i class="${icons[type]}"></i>
                    <div class="toast-content">
                        <div class="toast-title">${title}</div>
                        <div class="toast-message">${message}</div>
                    </div>
                    <button class="toast-close">
                        <i class="fas fa-times"></i>
                    </button>
                `;

                container.appendChild(toast);
                
                // Show animation
                setTimeout(() => toast.classList.add('show'), 100);
                
                // Auto remove
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => container.removeChild(toast), 300);
                }, 5000);

                // Manual close
                toast.querySelector('.toast-close').addEventListener('click', () => {
                    toast.classList.remove('show');
                    setTimeout(() => container.removeChild(toast), 300);
                });
            }

            static validateForm(formId) {
                const form = document.getElementById(formId);
                const requiredFields = form.querySelectorAll('[required]');
                let isValid = true;

                requiredFields.forEach(field => {
                    const errorMsg = field.parentElement.querySelector('.error-message');
                    
                    if (!field.value.trim()) {
                        field.classList.add('error');
                        if (errorMsg) errorMsg.classList.add('show');
                        isValid = false;
                    } else {
                        field.classList.remove('error');
                        if (errorMsg) errorMsg.classList.remove('show');
                    }
                });

                return isValid;
            }

            static updateProgress() {
                const steps = document.querySelectorAll('.step');
                const progressLine = document.getElementById('progressLine');
                const completionFill = document.getElementById('completionFill');
                const completionText = document.getElementById('completionText');
                
                let completed = 0;
                
                // Check comercio data
                const comercioForm = document.getElementById('comercioForm');
                if (comercioForm.checkValidity()) {
                    steps[0].classList.add('completed');
                    steps[0].classList.remove('active');
                    completed++;
                }

                // Check products/services
                if (productos.length > 0 || servicios.length > 0) {
                    steps[1].classList.add('completed');
                    steps[1].classList.remove('active');
                    completed++;
                }

                // Check configuration (horarios, delivery, etc)
                const hasHorarios = document.querySelectorAll('[name*="_abierto"]:checked').length > 0;
                if (hasHorarios) {
                    steps[2].classList.add('completed'); 
                    steps[2].classList.remove('active');
                    completed++;
                }

                // Check IA generation
                const aiGenerated = document.getElementById('aiPreviewSection').classList.contains('visible');
                if (aiGenerated) {
                    steps[3].classList.add('completed');
                    steps[3].classList.remove('active');
                    completed++;
                }

                // Update active step
                if (completed < 4) {
                    steps[completed].classList.add('active');
                }

                // Update progress bar
                const percentage = (completed / 4) * 100;
                progressLine.style.width = `${percentage}%`;
                completionFill.style.width = `${percentage}%`;
                completionText.textContent = `${percentage}% completado`;

                // Update step circles
                steps.forEach((step, index) => {
                    const circle = step.querySelector('.step-circle');
                    if (step.classList.contains('completed')) {
                        circle.innerHTML = '<i class="fas fa-check"></i>';
                    } else {
                        circle.textContent = index + 1;
                    }
                });
            }

            static formatCurrency(value) {
                return new Intl.NumberFormat('es-AR', {
                    style: 'currency',
                    currency: 'ARS'
                }).format(value);
            }

            static exportToCSV(data, filename) {
                const csv = data.map(row => Object.values(row).join(',')).join('\n');
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
            }
        }

        // Auth state management
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                const email = user.email;
                const name = email.split('@')[0];
                
                document.getElementById('userEmail').textContent = email;
                document.getElementById('userName').textContent = name.charAt(0).toUpperCase() + name.slice(1);
                document.getElementById('userAvatar').textContent = name.charAt(0).toUpperCase();
                
                loadUserData();
            } else {
                window.location.href = 'login.html';
            }
        });

        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            Utils.showLoading('Cerrando sesión...');
            try {
                await signOut(auth);
            } catch (error) {
                Utils.showToast('Error', 'No se pudo cerrar la sesión', 'error');
            } finally {
                Utils.hideLoading();
            }
        });

        // Tab functionality
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabName = button.dataset.tab;
                
                // Remove active classes
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
                
                // Add active classes
                button.classList.add('active');
                document.getElementById(tabName).classList.add('active');

                // Update notifications
                updateTabNotifications();
            });
        });

        function updateTabNotifications() {
            const productosNotif = document.getElementById('productosNotif');
            productosNotif.textContent = productos.length;
            productosNotif.classList.toggle('hidden', productos.length === 0);
        }

        // Plan selection
        document.querySelectorAll('.plan-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.plan-card').forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
                currentPlan = card.dataset.plan;
                Utils.showToast('Plan seleccionado', `Plan ${card.dataset.plan.toUpperCase()} seleccionado`, 'info');
            });
        });

        // Form handling - Comercio
        document.getElementById('comercioForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!Utils.validateForm('comercioForm')) {
                Utils.showToast('Campos incompletos', 'Por favor completa todos los campos obligatorios', 'warning');
                return;
            }

            Utils.showLoading('Guardando información...');

            try {
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                data.plan = currentPlan;
                data.mediosPago = Array.from(formData.getAll('mediosPago'));
                data.updatedAt = new Date();

                await setDoc(doc(db, 'comercios', currentUser.uid), data, { merge: true });
                Utils.showToast('¡Guardado!', 'Información del comercio guardada correctamente', 'success');
                Utils.updateProgress();
            } catch (error) {
                Utils.showToast('Error', 'No se pudo guardar: ' + error.message, 'error');
            } finally {
                Utils.hideLoading();
            }
        });

        // Reset form
        document.getElementById('resetForm').addEventListener('click', () => {
            if (confirm('¿Estás seguro de que quieres limpiar el formulario?')) {
                document.getElementById('comercioForm').reset();
                document.querySelectorAll('input.error').forEach(input => input.classList.remove('error'));
                document.querySelectorAll('.error-message.show').forEach(msg => msg.classList.remove('show'));
            }
        });

        // Delivery toggle
        document.getElementById('tieneDelivery').addEventListener('change', (e) => {
            const config = document.getElementById('deliveryConfig');
            if (e.target.checked) {
                config.classList.remove('hidden');
                config.classList.add('visible');
            } else {
                config.classList.add('hidden');
                config.classList.remove('visible');
            }
        });

        // Schedule management
        document.querySelectorAll('[name*="_abierto"]').forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const day = e.target.name.split('_')[0];
                const dayElement = document.querySelector(`[data-day="${day}"]`);
                
                if (e.target.checked) {
                    dayElement.classList.remove('disabled');
                } else {
                    dayElement.classList.add('disabled');
                }
            });
        });

        document.getElementById('guardarHorarios').addEventListener('click', async () => {
            Utils.showLoading('Guardando horarios...');
            
            try {
                const horarios = collectHorarios();
                await setDoc(doc(db, 'comercios', currentUser.uid), {
                    horarios: horarios,
                    horariosUpdatedAt: new Date()
                }, { merge: true });
                
                Utils.showToast('¡Guardado!', 'Horarios guardados correctamente', 'success');
                Utils.updateProgress();
            } catch (error) {
                Utils.showToast('Error', 'No se pudieron guardar los horarios: ' + error.message, 'error');
            } finally {
                Utils.hideLoading();
            }
        });

        function collectHorarios() {
            const dias = ['lunes', 'martes', 'miercoles', 'jueves', 'viernes', 'sabado', 'domingo'];
            const horarios = {};
            
            dias.forEach(dia => {
                const abierto = document.querySelector(`[name="${dia}_abierto"]`)?.checked;
                if (abierto) {
                    const mananaInicio = document.querySelector(`[name="${dia}_manana_inicio"]`)?.value;
                    const mananaFin = document.querySelector(`[name="${dia}_manana_fin"]`)?.value;
                    const tardeInicio = document.querySelector(`[name="${dia}_tarde_inicio"]`)?.value;
                    const tardeFin = document.querySelector(`[name="${dia}_tarde_fin"]`)?.value;
                    
                    let horario = '';
                    if (mananaInicio && mananaFin) {
                        horario += `${mananaInicio}-${mananaFin}`;
                    }
                    if (tardeInicio && tardeFin) {
                        horario += horario ? ` y ${tardeInicio}-${tardeFin}` : `${tardeInicio}-${tardeFin}`;
                    }
                    
                    if (horario) {
                        horarios[dia] = horario;
                    }
                }
            });
            
            return horarios;
        }

        // Categories management
        document.getElementById('agregarCategoria').addEventListener('click', () => {
            const input = document.getElementById('nuevaCategoria');
            const categoria = input.value.trim();
            
            if (!categoria) {
                Utils.showToast('Error', 'Escribe un nombre para la categoría', 'warning');
                return;
            }
            
            if (categorias.includes(categoria)) {
                Utils.showToast('Error', 'Esta categoría ya existe', 'warning');
                return;
            }
            
            agregarCategoria(categoria);
            input.value = '';
            actualizarSelectCategorias();
            Utils.showToast('¡Agregada!', `Categoría "${categoria}" agregada`, 'success');
        });

        function agregarCategoria(nombre) {
            if (categorias.includes(nombre)) return;
            
            categorias.push(nombre);
            const grid = document.getElementById('categoriasGrid');
            const div = document.createElement('div');
            div.className = 'category-item';
            div.innerHTML = `
                ${nombre}
                <button class="category-remove" onclick="removeCategoria(this)" title="Eliminar categoría">
                    <i class="fas fa-times"></i>
                </button>
            `;
            grid.appendChild(div);
        }

        function actualizarSelectCategorias() {
            const selects = ['productoCategoria'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '';
                categorias.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat;
                    option.textContent = cat;
                    select.appendChild(option);
                });
            });
        }

        // Products management
        document.getElementById('productoForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            if (!Utils.validateForm('productoForm')) {
                Utils.showToast('Campos incompletos', 'Por favor completa todos los campos obligatorios', 'warning');
                return;
            }
            
            const formData = new FormData(e.target);
            const producto = Object.fromEntries(formData);
            
            // Check if code already exists
            if (productos.some(p => p.codigo === producto.codigo)) {
                Utils.showToast('Error', 'Ya existe un producto con este código', 'error');
                return;
            }
            
            // Process arrays
            if (producto.talles) producto.talles = producto.talles.split(',').map(t => t.trim());
            if (producto.colores) producto.colores = producto.colores.split(',').map(c => c.trim());
            
            producto.destacado = formData.has('destacado');
            producto.activo = formData.has('activo');
            producto.id = Date.now().toString();
            
            productos.push(producto);
            addProductToTable(producto);
            
            e.target.reset();
            document.querySelector('#productoActivo').checked = true;
            
            Utils.showToast('¡Agregado!', `Producto "${producto.nombre}" agregado correctamente`, 'success');
            updateTabNotifications();
            Utils.updateProgress();
        });

        function addProductToTable(producto) {
            const tbody = document.getElementById('productsTableBody');
            
            // Remove empty state if exists
            if (tbody.querySelector('.empty-state')) {
                tbody.innerHTML = '';
            }
            
            const row = tbody.insertRow();
            row.dataset.productId = producto.id;
            row.innerHTML = `
                <td>${producto.codigo}</td>
                <td>
                    ${producto.nombre} 
                    ${producto.destacado ? '<i class="fas fa-star featured" title="Destacado"></i>' : ''}
                </td>
                <td>${producto.categoria || 'General'}</td>
                <td>${Utils.formatCurrency(parseFloat(producto.precio || 0))}</td>
                <td>${producto.stock || '∞'}</td>
                <td>
                    <span class="status-badge ${producto.activo ? 'status-active' : 'status-inactive'}">
                        ${producto.activo ? 'Activo' : 'Inactivo'}
                    </span>
                </td>
                <td>
                    <div class="action-buttons">
                        <button class="btn btn-sm btn-secondary" onclick="editProduct('${producto.id}')" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteProduct('${producto.id}')" title="Eliminar">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            `;
        }

        document.getElementById('limpiarProducto').addEventListener('click', () => {
            document.getElementById('productoForm').reset();
            document.querySelector('#productoActivo').checked = true;
        });

        // Services management
        document.getElementById('servicioForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            if (!Utils.validateForm('servicioForm')) {
                Utils.showToast('Campos incompletos', 'Por favor completa todos los campos obligatorios', 'warning');
                return;
            }
            
            const formData = new FormData(e.target);
            const servicio = Object.fromEntries(formData);
            
            servicio.destacado = formData.has('destacado');
            servicio.activo = formData.has('activo');
            servicio.id = Date.now().toString();
            
            servicios.push(servicio);
            addServiceToTable(servicio);
            
            e.target.reset();
            document.querySelector('#servicioActivo').checked = true;
            
            Utils.showToast('¡Agregado!', `Servicio "${servicio.nombre}" agregado correctamente`, 'success');
            Utils.updateProgress();
        });

        function addServiceToTable(servicio) {
            const tbody = document.getElementById('serviciosTableBody');
            
            if (tbody.querySelector('.empty-state')) {
                tbody.innerHTML = '';
            }
            
            const row = tbody.insertRow();
            row.dataset.serviceId = servicio.id;
            row.innerHTML = `
                <td>
                    ${servicio.nombre}
                    ${servicio.destacado ? '<i class="fas fa-star featured" title="Destacado"></i>' : ''}
                </td>
                <td>${servicio.categoria}</td>
                <td>${Utils.formatCurrency(parseFloat(servicio.precio || 0))}</td>
                <td>${servicio.duracion || '-'}</td>
                <td>${servicio.modalidad}</td>
                <td>
                    <span class="status-badge ${servicio.activo ? 'status-active' : 'status-inactive'}">
                        ${servicio.activo ? 'Activo' : 'Inactivo'}
                    </span>
                </td>
                <td>
                    <div class="action-buttons">
                        <button class="btn btn-sm btn-secondary" onclick="editService('${servicio.id}')" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteService('${servicio.id}')" title="Eliminar">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            `;
        }

        document.getElementById('limpiarServicio').addEventListener('click', () => {
            document.getElementById('servicioForm').reset();
            document.querySelector('#servicioActivo').checked = true;
        });

        // File upload handling
        const fileUpload = document.getElementById('fileUpload');
        const fileInput = document.getElementById('excelFile');

        fileUpload.addEventListener('click', () => fileInput.click());
        
        fileUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUpload.classList.add('dragover');
        });
        
        fileUpload.addEventListener('dragleave', () => {
            fileUpload.classList.remove('dragover');
        });
        
        fileUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUpload.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processExcelFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                processExcelFile(e.target.files[0]);
            }
        });

        function processExcelFile(file) {
            Utils.showLoading('Procesando archivo...');
            
            // Simulate file processing
            setTimeout(() => {
                const mockProducts = [
                    { 
                        codigo: 'EXCEL001', 
                        nombre: 'Producto desde Excel 1', 
                        categoria: 'General', 
                        precio: '150.00', 
                        stock: '10', 
                        activo: true,
                        destacado: false,
                        id: Date.now().toString()
                    },
                    { 
                        codigo: 'EXCEL002', 
                        nombre: 'Producto desde Excel 2', 
                        categoria: 'General', 
                        precio: '200.00', 
                        stock: '5', 
                        activo: true,
                        destacado: true,
                        id: (Date.now() + 1).toString()
                    }
                ];
                
                mockProducts.forEach(producto => {
                    if (!productos.some(p => p.codigo === producto.codigo)) {
                        productos.push(producto);
                        addProductToTable(producto);
                    }
                });
                
                fileUpload.classList.add('success');
                setTimeout(() => fileUpload.classList.remove('success'), 3000);
                
                Utils.showToast('¡Procesado!', `Excel procesado. Se agregaron ${mockProducts.length} productos.`, 'success');
                updateTabNotifications();
                Utils.updateProgress();
                Utils.hideLoading();
            }, 2000);
        }

        // Delivery configuration
        document.getElementById('guardarDelivery').addEventListener('click', async () => {
            Utils.showLoading('Guardando configuración...');
            
            try {
                const deliveryData = {
                    tieneDelivery: document.getElementById('tieneDelivery').checked,
                    precioDelivery: document.getElementById('precioDelivery').value,
                    tiempoDelivery: document.getElementById('tiempoDelivery').value,
                    minimoDelivery: document.getElementById('minimoDelivery').value,
                    radioCobertura: document.getElementById('radioCobertura').value,
                    zonasDelivery: document.getElementById('zonasDelivery').value,
                    metodosEnvio: Array.from(document.querySelectorAll('[name="metodosEnvio"]:checked')).map(cb => cb.value),
                    politicaEnvio: document.getElementById('politicaEnvio').value,
                    deliveryUpdatedAt: new Date()
                };

                await setDoc(doc(db, 'comercios', currentUser.uid), deliveryData, { merge: true });
                Utils.showToast('¡Guardado!', 'Configuración de delivery guardada', 'success');
                Utils.updateProgress();
            } catch (error) {
                Utils.showToast('Error', 'No se pudo guardar: ' + error.message, 'error');
            } finally {
                Utils.hideLoading();
            }
        });

        // AI Configuration
        document.getElementById('configIAForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!Utils.validateForm('configIAForm')) {
                Utils.showToast('Campos incompletos', 'Por favor completa todos los campos obligatorios', 'warning');
                return;
            }

            if (productos.length === 0 && servicios.length === 0) {
                Utils.showToast('Sin productos/servicios', 'Agrega al menos un producto o servicio antes de generar la IA', 'warning');
                return;
            }

            Utils.showLoading('Generando tu IA...');

            try {
                const comercioData = await collectAllData();
                const fullJSON = generateFullJSON(comercioData);
                const prompt = generatePrompt(fullJSON);
                
                const aiLink = `https://chat.openai.com/?q=${encodeURIComponent(prompt)}`;
                
                await setDoc(doc(db, 'comercios', currentUser.uid), {
                    jsonData: fullJSON,
                    aiLink: aiLink,
                    aiGenerated: true,
                    generatedAt: new Date()
                }, { merge: true });
                
                document.getElementById('aiLinkDisplay').textContent = aiLink;
                document.getElementById('aiPreviewSection').classList.remove('hidden');
                document.getElementById('aiPreviewSection').classList.add('visible');
                document.getElementById('noIAMessage').style.display = 'none';

                const nombreComercio = comercioData.nombreComercio || 'nuestro negocio';
                const textoCompartir = `🤖 ¡Ahora ${nombreComercio} tiene atención con IA las 24 horas! Consultá precios, stock, horarios y más. ¡Probala aquí! 👆`;
                document.getElementById('textoCompartir').textContent = textoCompartir;

                Utils.showToast('¡IA generada!', 'Tu asistente inteligente está listo para usar', 'success');
                Utils.updateProgress();
            } catch (error) {
                Utils.showToast('Error', 'No se pudo generar la IA: ' + error.message, 'error');
            } finally {
                Utils.hideLoading();
            }
        });

        async function collectAllData() {
            try {
                const docSnap = await getDoc(doc(db, 'comercios', currentUser.uid));
                return docSnap.exists() ? docSnap.data() : {};
            } catch (error) {
                console.error('Error loading data:', error);
                return {};
            }
        }

        function generateFullJSON(data) {
            const horarios = collectHorarios();
            
                            return {
                comercio: {
                    nombre: data.nombreComercio || '',
                    rubro: data.rubro || '',
                    direccion: data.direccion || '',
                    localidad: data.localidad || '',
                    telefono: data.telefono || '',
                    whatsapp: data.whatsapp || '',
                    email: data.email || '',
                    website: data.website || '',
                    horarios: horarios,
                    redes_sociales: {
                        instagram: data.instagram || '',
                        facebook: data.facebook || ''
                    },
                    medios_pago: data.mediosPago || [],
                    descripcion: data.descripcion || '',
                    politicas: {
                        devolucion: data.politicaDevolucion || '',
                        tiempo_preparacion: data.tiempoPreparacion || '',
                        descuento_cantidad: data.descuentoCantidad || ''
                    }
                },
                asistente_ia: {
                    nombre: data.nombreIA || `${data.nombreComercio} IA`,
                    tono: data.tonoPersonalizado || data.tonoIA || 'amigable',
                    logo_url: data.logoURL || '',
                    saludo_personalizado: data.mensajeBienvenida || `¡Hola! Soy ${data.nombreIA || data.nombreComercio + ' IA'} 👋`,
                    despedida: data.mensajeDespedida || '¡Gracias por contactarnos!',
                    emojis_preferidos: data.emojisPreferidos || '',
                    respuesta_fuera_horario: data.respuestasFueraHorario || ''
                },
                productos: productos,
                servicios: servicios,
                delivery: {
                    disponible: data.tieneDelivery || false,
                    precio: data.precioDelivery || 0,
                    tiempo: data.tiempoDelivery || '',
                    minimo_gratis: data.minimoDelivery || 0,
                    radio_cobertura: data.radioCobertura || '',
                    zonas: data.zonasDelivery || '',
                    metodos_envio: data.metodosEnvio || [],
                    politica: data.politicaEnvio || ''
                },
                configuracion_ia: {
                    permisos: Array.from(document.querySelectorAll('[name="permisosIA"]:checked')).map(cb => cb.value),
                    limite_descuento: data.limiteDescuento || 0,
                    instrucciones_especiales: data.instruccionesEspeciales || '',
                    plan: data.plan || currentPlan
                }
            };
        }

        function generatePrompt(jsonData) {
            const comercio = jsonData.comercio;
            const ia = jsonData.asistente_ia;
            
            let prompt = `Eres ${ia.nombre}, la IA de ${comercio.nombre}`;
            if (comercio.rubro) prompt += `, especializada en ${comercio.rubro}`;
            prompt += `.\n\n`;

            if (ia.logo_url) {
                prompt += `SALUDO INICIAL CON LOGO:\n"${ia.saludo_personalizado} Mira nuestro logo: ${ia.logo_url} ¿En qué te puedo ayudar?"\n\n`;
            } else {
                prompt += `SALUDO INICIAL:\n"${ia.saludo_personalizado} ¿En qué te puedo ayudar?"\n\n`;
            }

            prompt += `INFORMACIÓN COMPLETA DEL NEGOCIO:\n${JSON.stringify(jsonData, null, 2)}\n\n`;

            prompt += `INSTRUCCIONES:\n`;
            prompt += `- Personalidad: ${ia.tono}\n`;
            prompt += `- Solo usa información de este JSON\n`;
            prompt += `- Para reservas/pedidos deriva a: ${comercio.whatsapp || comercio.telefono}\n`;
            prompt += `- Si no tienes un dato exacto, deriva al contacto\n`;
            prompt += `- Nunca inventes precios ni información\n`;
            if (ia.emojis_preferidos) prompt += `- Usa estos emojis: ${ia.emojis_preferidos}\n`;
            if (jsonData.configuracion_ia.limite_descuento > 0) {
                prompt += `- Puedes ofrecer hasta ${jsonData.configuracion_ia.limite_descuento}% de descuento\n`;
            }
            if (jsonData.configuracion_ia.instrucciones_especiales) {
                prompt += `- Instrucciones especiales: ${jsonData.configuracion_ia.instrucciones_especiales}\n`;
            }

            return prompt;
        }

        // AI Actions
        document.getElementById('copyLinkBtn').addEventListener('click', () => {
            const link = document.getElementById('aiLinkDisplay').textContent;
            navigator.clipboard.writeText(link).then(() => {
                Utils.showToast('¡Copiado!', 'Link copiado al portapapeles', 'success');
            });
        });

        document.getElementById('copyTextoBtn').addEventListener('click', () => {
            const texto = document.getElementById('textoCompartir').textContent;
            navigator.clipboard.writeText(texto).then(() => {
                Utils.showToast('¡Copiado!', 'Texto copiado al portapapeles', 'success');
            });
        });

        document.getElementById('testAIBtn').addEventListener('click', () => {
            const testSection = document.getElementById('aiTestSection');
            testSection.classList.toggle('hidden');
            if (!testSection.classList.contains('hidden')) {
                Utils.showToast('Modo test', 'Puedes probar tu IA aquí. Las respuestas son simuladas.', 'info');
            }
        });

        document.getElementById('shareAIBtn').addEventListener('click', () => {
            const link = document.getElementById('aiLinkDisplay').textContent;
            if (navigator.share) {
                navigator.share({
                    title: 'Mi IA Comercial',
                    text: '🤖 ¡Prueba nuestra IA las 24 horas!',
                    url: link
                });
            } else {
                // Fallback
                Utils.showToast('Compartir', 'Copia el link para compartir en tus redes sociales', 'info');
            }
        });

        // Chat functionality (simulated)
        document.getElementById('chatSendBtn').addEventListener('click', sendChatMessage);
        document.getElementById('chatInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendChatMessage();
            }
        });

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const container = document.getElementById('chatContainer');
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'chat-message user';
            userMsg.innerHTML = `
                ${message}
                <div class="chat-message-time">${new Date().toLocaleTimeString()}</div>
            `;
            container.appendChild(userMsg);
            
            input.value = '';
            
            // Simulate AI response
            setTimeout(() => {
                const aiMsg = document.createElement('div');
                aiMsg.className = 'chat-message ai';
                aiMsg.innerHTML = `
                    ${generateMockResponse(message)}
                    <div class="chat-message-time">${new Date().toLocaleTimeString()}</div>
                `;
                container.appendChild(aiMsg);
                container.scrollTop = container.scrollHeight;
            }, 1000);
            
            container.scrollTop = container.scrollHeight;
        }

        function generateMockResponse(message) {
            const responses = [
                "¡Hola! Gracias por tu consulta. Te puedo ayudar con información sobre nuestros productos y servicios.",
                "Para obtener información específica sobre precios y stock, te voy a conectar con nuestro WhatsApp.",
                "¡Excelente pregunta! Basándome en nuestro catálogo, te recomiendo...",
                "Nuestros horarios de atención son los que están configurados en el sistema.",
                "Para realizar tu pedido, te paso el contacto directo de WhatsApp."
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // Export functions
        document.getElementById('exportarProductos').addEventListener('click', () => {
            if (productos.length === 0) {
                Utils.showToast('Sin datos', 'No hay productos para exportar', 'warning');
                return;
            }
            
            Utils.exportToCSV(productos, 'productos.csv');
            Utils.showToast('¡Exportado!', 'Productos exportados a CSV', 'success');
        });

        document.getElementById('exportarServicios').addEventListener('click', () => {
            if (servicios.length === 0) {
                Utils.showToast('Sin datos', 'No hay servicios para exportar', 'warning');
                return;
            }
            
            Utils.exportToCSV(servicios, 'servicios.csv');
            Utils.showToast('¡Exportado!', 'Servicios exportados a CSV', 'success');
        });

        // Clear functions
        document.getElementById('limpiarProductos').addEventListener('click', () => {
            if (confirm('¿Estás seguro de que quieres eliminar TODOS los productos?')) {
                productos = [];
                document.getElementById('productsTableBody').innerHTML = `
                    <tr>
                        <td colspan="7">
                            <div class="empty-state">
                                <div class="empty-state-icon">
                                    <i class="fas fa-box-open"></i>
                                </div>
                                <h3>No hay productos cargados</h3>
                                <p>Agrega productos manualmente o sube un Excel para comenzar</p>
                            </div>
                        </td>
                    </tr>
                `;
                updateTabNotifications();
                Utils.showToast('¡Limpiado!', 'Todos los productos han sido eliminados', 'success');
            }
        });

        document.getElementById('limpiarServicios').addEventListener('click', () => {
            if (confirm('¿Estás seguro de que quieres eliminar TODOS los servicios?')) {
                servicios = [];
                document.getElementById('serviciosTableBody').innerHTML = `
                    <tr>
                        <td colspan="7">
                            <div class="empty-state">
                                <div class="empty-state-icon">
                                    <i class="fas fa-cogs"></i>
                                </div>
                                <h3>No hay servicios registrados</h3>
                                <p>Agrega servicios usando el formulario anterior</p>
                            </div>
                        </td>
                    </tr>
                `;
                Utils.showToast('¡Limpiado!', 'Todos los servicios han sido eliminados', 'success');
            }
        });

        // Load user data
        async function loadUserData() {
            Utils.showLoading('Cargando datos...');
            
            try {
                const docSnap = await getDoc(doc(db, 'comercios', currentUser.uid));
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    
                    // Fill form fields
                    Object.keys(data).forEach(key => {
                        const field = document.getElementById(key);
                        if (field) {
                            if (field.type === 'checkbox') {
                                field.checked = data[key];
                            } else {
                                field.value = data[key];
                            }
                        }
                    });

                    // Handle checkboxes arrays
                    if (data.mediosPago) {
                        data.mediosPago.forEach(medio => {
                            const checkbox = document.querySelector(`[name="mediosPago"][value="${medio}"]`);
                            if (checkbox) checkbox.checked = true;
                        });
                    }

                    if (data.metodosEnvio) {
                        data.metodosEnvio.forEach(metodo => {
                            const checkbox = document.querySelector(`[name="metodosEnvio"][value="${metodo}"]`);
                            if (checkbox) checkbox.checked = true;
                        });
                    }

                    // Show delivery config if enabled
                    if (data.tieneDelivery) {
                        document.getElementById('deliveryConfig').classList.remove('hidden');
                        document.getElementById('deliveryConfig').classList.add('visible');
                    }

                    // Show AI link if exists
                    if (data.aiLink) {
                        document.getElementById('aiLinkDisplay').textContent = data.aiLink;
                        document.getElementById('aiPreviewSection').classList.remove('hidden');
                        document.getElementById('aiPreviewSection').classList.add('visible');
                        document.getElementById('noIAMessage').style.display = 'none';
                    }

                    // Set plan selection
                    if (data.plan) {
                        document.querySelectorAll('.plan-card').forEach(card => {
                            card.classList.remove('selected');
                            if (card.dataset.plan === data.plan) {
                                card.classList.add('selected');
                            }
                        });
                        currentPlan = data.plan;
                    }

                    // Load productos and servicios if they exist
                    if (data.productos) {
                        productos = data.productos;
                        productos.forEach(addProductToTable);
                    }
                    
                    if (data.servicios) {
                        servicios = data.servicios;
                        servicios.forEach(addServiceToTable);
                    }
                }
            } catch (error) {
                console.error('Error loading data:', error);
                Utils.showToast('Error', 'No se pudieron cargar los datos', 'error');
            } finally {
                Utils.hideLoading();
                Utils.updateProgress();
                updateTabNotifications();
            }
        }

        // Global functions for inline handlers
        window.removeCategoria = function(button) {
            const categoryName = button.closest('.category-item').textContent.replace('×', '').trim();
            
            if (categoryName === 'General') {
                Utils.showToast('Error', 'No puedes eliminar la categoría General', 'error');
                return;
            }
            
            if (confirm(`¿Eliminar la categoría "${categoryName}"?`)) {
                categorias = categorias.filter(cat => cat !== categoryName);
                button.closest('.category-item').remove();
                actualizarSelectCategorias();
                Utils.showToast('¡Eliminada!', `Categoría "${categoryName}" eliminada`, 'success');
            }
        };
        
        window.deleteProduct = function(productId) {
            const product = productos.find(p => p.id === productId);
            if (!product) return;
            
            if (confirm(`¿Eliminar el producto "${product.nombre}"?`)) {
                productos = productos.filter(p => p.id !== productId);
                document.querySelector(`tr[data-product-id="${productId}"]`).remove();
                
                const tbody = document.getElementById('productsTableBody');
                if (tbody.children.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="7">
                                <div class="empty-state">
                                    <div class="empty-state-icon">
                                        <i class="fas fa-box-open"></i>
                                    </div>
                                    <h3>No hay productos cargados</h3>
                                    <p>Agrega productos manualmente o sube un Excel para comenzar</p>
                                </div>
                            </td>
                        </tr>
                    `;
                }
                
                updateTabNotifications();
                Utils.showToast('¡Eliminado!', `Producto "${product.nombre}" eliminado`, 'success');
            }
        };

        window.editProduct = function(productId) {
            const product = productos.find(p => p.id === productId);
            if (!product) return;
            
            // Fill form with product data
            document.getElementById('productoCodigo').value = product.codigo;
            document.getElementById('productoNombre').value = product.nombre;
            document.getElementById('productoCategoria').value = product.categoria || 'General';
            document.getElementById('productoMarca').value = product.marca || '';
            document.getElementById('productoPrecio').value = product.precio;
            document.getElementById('productoStock').value = product.stock || '';
            document.getElementById('productoTalles').value = product.talles ? product.talles.join(',') : '';
            document.getElementById('productoColores').value = product.colores ? product.colores.join(',') : '';
            document.getElementById('productoImagen').value = product.imagen || '';
            document.getElementById('productoDescripcion').value = product.descripcion || '';
            document.getElementById('productoDestacado').checked = product.destacado;
            document.getElementById('productoActivo').checked = product.activo;
            
            // Remove product from array (will be re-added on form submit)
            productos = productos.filter(p => p.id !== productId);
            document.querySelector(`tr[data-product-id="${productId}"]`).remove();
            
            // Switch to productos tab and scroll to form
            document.querySelector('[data-tab="productos"]').click();
            document.getElementById('productoForm').scrollIntoView({ behavior: 'smooth' });
            
            Utils.showToast('Editando', `Editando producto "${product.nombre}"`, 'info');
        };

        window.deleteService = function(serviceId) {
            const service = servicios.find(s => s.id === serviceId);
            if (!service) return;
            
            if (confirm(`¿Eliminar el servicio "${service.nombre}"?`)) {
                servicios = servicios.filter(s => s.id !== serviceId);
                document.querySelector(`tr[data-service-id="${serviceId}"]`).remove();
                
                const tbody = document.getElementById('serviciosTableBody');
                if (tbody.children.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="7">
                                <div class="empty-state">
                                    <div class="empty-state-icon">
                                        <i class="fas fa-cogs"></i>
                                    </div>
                                    <h3>No hay servicios registrados</h3>
                                    <p>Agrega servicios usando el formulario anterior</p>
                                </div>
                            </td>
                        </tr>
                    `;
                }
                
                Utils.showToast('¡Eliminado!', `Servicio "${service.nombre}" eliminado`, 'success');
            }
        };

        window.editService = function(serviceId) {
            const service = servicios.find(s => s.id === serviceId);
            if (!service) return;
            
            // Fill form with service data
            document.getElementById('servicioNombre').value = service.nombre;
            document.getElementById('servicioCategoria').value = service.categoria;
            document.getElementById('servicioPrecio').value = service.precio;
            document.getElementById('servicioDuracion').value = service.duracion || '';
            document.getElementById('servicioModalidad').value = service.modalidad;
            document.getElementById('servicioRequisitos').value = service.requisitos || '';
            document.getElementById('servicioDescripcion').value = service.descripcion || '';
            document.getElementById('servicioDestacado').checked = service.destacado;
            document.getElementById('servicioActivo').checked = service.activo;
            
            // Remove service from array (will be re-added on form submit)
            servicios = servicios.filter(s => s.id !== serviceId);
            document.querySelector(`tr[data-service-id="${serviceId}"]`).remove();
            
            // Switch to servicios tab and scroll to form
            document.querySelector('[data-tab="servicios"]').click();
            document.getElementById('servicioForm').scrollIntoView({ behavior: 'smooth' });
            
            Utils.showToast('Editando', `Editando servicio "${service.nombre}"`, 'info');
        };

        // Auto-resize textareas
        document.querySelectorAll('textarea').forEach(textarea => {
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
        });

        // Auto-save draft functionality
        let autoSaveTimeout;
        document.querySelectorAll('input, textarea, select').forEach(field => {
            field.addEventListener('input', () => {
                clearTimeout(autoSaveTimeout);
                autoSaveTimeout = setTimeout(() => {
                    // Auto-save to localStorage as draft
                    const formData = new FormData(field.closest('form'));
                    const data = Object.fromEntries(formData);
                    localStorage.setItem(`indiceia_draft_${field.closest('form').id}`, JSON.stringify(data));
                }, 2000);
            });
        });

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            // Set default values
            actualizarSelectCategorias();
            Utils.updateProgress();
            
            // Add some sample categories for demo
            setTimeout(() => {
                if (categorias.length === 1) {
                    ['Destacados', 'Ofertas', 'Nuevo'].forEach(cat => {
                        agregarCategoria(cat);
                    });
                    actualizarSelectCategorias();
                }
            }, 1000);
        });

        console.log('INDICEIA Dashboard loaded successfully');
    </script>
</body>
</html>
                <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INDICEIA - Tu IA Comercial</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #22c55e;
            --dark: #1f2937;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --border-radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gradient-primary);
            color: var(--gray-900);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Utilities */
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        .mt-0 { margin-top: 0; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-0 { margin-bottom: 0; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .hidden { display: none !important; }
        .visible { display: block !important; }
        .flex { display: flex; }
        .grid { display: grid; }
        .gap-2 { gap: 0.5rem; }
        .gap-4 { gap: 1rem; }
        .w-full { width: 100%; }
        .h-full { height: 100%; }

        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .loading-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--gray-200);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            margin-top: 16px;
            color: var(--gray-600);
            font-weight: 500;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            max-width: 400px;
        }

        .toast {
            background: white;
            padding: 16px 20px;
            margin-bottom: 12px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--success);
            min-width: 300px;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast.info {
            border-left-color: var(--primary);
        }

        .toast i {
            font-size: 18px;
            flex-shrink: 0;
        }

        .toast.success i { color: var(--success); }
        .toast.error i { color: var(--danger); }
        .toast.warning i { color: var(--warning); }
        .toast.info i { color: var(--primary); }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 2px;
            color: var(--gray-900);
        }

        .toast-message {
            font-size: 14px;
            color: var(--gray-600);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--gray-400);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .toast-close:hover {
            background: var(--gray-100);
            color: var(--gray-600);
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 16px 24px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo h1 {
            font-size: 28px;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 44px;
            height: 44px;
            background: var(--gradient-primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            box-shadow: var(--shadow);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
            box-shadow: var(--shadow);
        }

        .user-details {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .user-name {
            font-weight: 600;
            color: var(--gray-900);
            font-size: 14px;
        }

        .user-email {
            color: var(--gray-500);
            font-size: 12px;
        }
        
        .btn-logout {
            padding: 10px 16px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-logout:hover {
            background: #dc2626;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        /* Progress indicator */
        .progress-indicator {
            background: white;
            border-radius: var(--border-radius);
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-200);
        }

        .progress-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .progress-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 4px;
        }

        .progress-subtitle {
            font-size: 14px;
            color: var(--gray-500);
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin-bottom: 16px;
            align-items: center;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 40px;
            right: 40px;
            height: 3px;
            background: var(--gray-200);
            z-index: 1;
            border-radius: 2px;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 40px;
            height: 3px;
            background: var(--gradient-primary);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 2;
            border-radius: 2px;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            position: relative;
            z-index: 3;
            min-width: 80px;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gray-200);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 3px solid var(--gray-200);
            color: var(--gray-500);
        }

        .step.active .step-circle {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.2);
        }

        .step.completed .step-circle {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .step.completed .step-circle i {
            font-size: 16px;
        }

        .step-label {
            font-size: 12px;
            color: var(--gray-600);
            text-align: center;
            font-weight: 500;
            line-height: 1.3;
        }

        .step.active .step-label {
            color: var(--primary);
            font-weight: 600;
        }

        .step.completed .step-label {
            color: var(--success);
            font-weight: 600;
        }

        /* Main content */
        .main-content {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--gray-200);
        }
        
        .tab-nav {
            display: flex;
            border-bottom: 2px solid var(--gray-100);
            overflow-x: auto;
            background: var(--gray-50);
            scrollbar-width: none;
        }

        .tab-nav::-webkit-scrollbar {
            display: none;
        }
        
        .tab-button {
            padding: 18px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-600);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }
        
        .tab-button:hover {
            background: white;
            color: var(--primary);
        }
        
        .tab-button.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: white;
        }

        .tab-button.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
        }

        .tab-button i {
            font-size: 16px;
        }

        .tab-notification {
            background: var(--danger);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }
        
        .tab-content {
            padding: 40px;
            min-height: 600px;
        }
        
        .tab-pane {
            display: none;
            animation: fadeInUp 0.4s ease-out;
        }
        
        .tab-pane.active {
            display: block;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        /* Forms */
        .form-section {
            margin-bottom: 48px;
        }

        .form-section:last-child {
            margin-bottom: 0;
        }

        .form-section h3 {
            color: var(--gray-900);
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--gray-100);
        }

        .form-section h3 i {
            color: var(--primary);
            font-size: 18px;
        }

        .form-section-subtitle {
            color: var(--gray-600);
            font-size: 14px;
            margin-bottom: 24px;
            margin-top: -12px;
        }
        
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--gray-700);
            font-size: 14px;
        }

        .form-group label .required {
            color: var(--danger);
            margin-left: 4px;
        }

        .form-group label .optional {
            color: var(--gray-400);
            font-weight: 400;
            font-size: 12px;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: white;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        .form-group input.error,
        .form-group textarea.error,
        .form-group select.error {
            border-color: var(--danger);
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1);
        }

        .form-group input:valid,
        .form-group textarea:valid,
        .form-group select:valid {
            border-color: var(--success);
        }

        .error-message {
            color: var(--danger);
            font-size: 12px;
            margin-top: 6px;
            display: none;
            padding: 4px 8px;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 4px;
            border-left: 3px solid var(--danger);
        }

        .error-message.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { 
                opacity: 0; 
                transform: translateY(-10px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .form-group textarea {
            height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .form-group input[type="file"] {
            padding: 0;
            border: none;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .form-row,
            .form-row-3 {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }

        /* Input groups */
        .input-group {
            display: flex;
            align-items: center;
            border: 2px solid var(--gray-200);
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .input-group:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        .input-group-prepend,
        .input-group-append {
            padding: 14px 16px;
            background: var(--gray-50);
            color: var(--gray-600);
            font-weight: 600;
            font-size: 14px;
            border-right: 1px solid var(--gray-200);
        }

        .input-group input {
            border: none;
            background: transparent;
            padding: 14px 16px;
            flex: 1;
        }

        .input-group input:focus {
            outline: none;
            box-shadow: none;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            user-select: none;
            justify-content: center;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn i {
            font-size: 16px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
            border: 1px solid var(--gray-200);
        }

        .btn-secondary:hover:not(:disabled) {
            background: var(--gray-200);
            transform: translateY(-1px);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-success:hover:not(:disabled) {
            background: #16a34a;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-danger:hover:not(:disabled) {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover:not(:disabled) {
            background: var(--primary);
            color: white;
        }

        .btn-lg {
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 700;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 12px;
        }

        /* Button groups */
        .btn-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }

        .btn-group-end {
            justify-content: flex-end;
        }

        .btn-group-start {
            justify-content: flex-start;
        }

        /* Plan selector */
        .plan-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin: 32px 0;
        }
        
        .plan-card {
            padding: 28px;
            border: 2px solid var(--gray-200);
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
            position: relative;
            overflow: hidden;
        }

        .plan-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .plan-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .plan-card.selected::before {
            transform: scaleX(1);
        }
        
        .plan-card.selected {
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.15);
            transform: translateY(-8px);
        }

        .plan-card.popular {
            border-color: var(--warning);
            position: relative;
        }

        .plan-card.popular::after {
            content: 'MÁS POPULAR';
            position: absolute;
            top: 16px;
            right: -30px;
            background: var(--warning);
            color: white;
            padding: 4px 40px;
            font-size: 10px;
            font-weight: 700;
            transform: rotate(45deg);
            letter-spacing: 1px;
        }

        .plan-card h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .plan-card .plan-subtitle {
            font-size: 14px;
            color: var(--gray-500);
            margin-bottom: 20px;
        }
        
        .plan-price {
            font-size: 40px;
            font-weight: 800;
            color: var(--primary);
            margin: 20px 0;
            display: flex;
            align-items: baseline;
            justify-content: center;
            gap: 4px;
        }

        .plan-price .currency {
            font-size: 20px;
            color: var(--gray-600);
        }

        .plan-price .period {
            font-size: 16px;
            color: var(--gray-500);
            font-weight: 500;
        }
        
        .plan-features {
            list-style: none;
            text-align: left;
            margin: 24px 0;
            padding: 0;
        }
        
        .plan-features li {
            padding: 10px 0;
            color: var(--gray-600);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
            border-bottom: 1px solid var(--gray-100);
        }

        .plan-features li:last-child {
            border-bottom: none;
        }

        .plan-features li i {
            color: var(--success);
            width: 18px;
            font-size: 14px;
        }

        .plan-features li.not-included i {
            color: var(--gray-300);
        }

        .plan-features li.not-included {
            color: var(--gray-400);
        }

        /* File upload */
        .file-upload {
            border: 3px dashed var(--gray-200);
            border-radius: var(--border-radius);
            padding: 48px 24px;
            text-align: center;
            margin: 24px 0;
            transition: all 0.3s ease;
            background: var(--gray-50);
            cursor: pointer;
            position: relative;
        }
        
        .file-upload:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
            transform: scale(1.02);
        }
        
        .file-upload.dragover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            transform: scale(1.05);
        }

        .file-upload i {
            font-size: 64px;
            color: var(--primary);
            margin-bottom: 20px;
            display: block;
        }

        .file-upload h3 {
            color: var(--gray-900);
            margin-bottom: 8px;
            font-size: 18px;
        }

        .file-upload p {
            color: var(--gray-600);
            font-size: 14px;
            margin-bottom: 16px;
        }

        .file-upload-success {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
        }

        .file-upload.success .file-upload-success {
            display: block;
        }

        .file-upload.success .file-upload-content {
            opacity: 0.3;
        }

        .file-format-info {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
            font-size: 13px;
            color: var(--success);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .file-format-info i {
            font-size: 16px;
        }

        /* Tables */
        .table-container {
            background: white;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-200);
            overflow: hidden;
            margin: 24px 0;
            box-shadow: var(--shadow);
        }

        .table-header {
            padding: 20px 24px;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .table-actions {
            display: flex;
            gap: 8px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th,
        .table td {
            padding: 16px 24px;
            text-align: left;
            border-bottom: 1px solid var(--gray-100);
            font-size: 14px;
        }
        
        .table th {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-700);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table tbody tr {
            transition: all 0.2s ease;
        }

        .table tbody tr:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        .table .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table .status-active {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }

        .table .status-inactive {
            background: rgba(156, 163, 175, 0.2);
            color: var(--gray-500);
        }

        .table .featured {
            color: var(--warning);
            font-weight: 600;
        }

        .table .action-buttons {
            display: flex;
            gap: 8px;
        }

        .table .btn-sm {
            padding: 6px 12px;
            font-size: 11px;
        }

        /* Checkbox groups */
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: var(--gray-50);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .checkbox-item:hover {
            background: rgba(99, 102, 241, 0.05);
            border-color: var(--primary);
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
            color: var(--gray-700);
        }

        .checkbox-item label i {
            font-size: 16px;
            color: var(--primary);
        }

        /* AI Preview */
        .ai-preview {
            background: var(--gradient-primary);
            border-radius: 16px;
            padding: 32px;
            color: white;
            margin: 32px 0;
            position: relative;
            overflow: hidden;
        }

        .ai-preview::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transform: rotate(-45deg);
        }

        .ai-preview-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
        }

        .ai-preview-header h3 {
            font-size: 24px;
            font-weight: 700;
            margin: 0;
        }

        .ai-preview-header i {
            font-size: 28px;
        }

        .ai-preview-content {
            position: relative;
            z-index: 2;
        }

        .ai-link-display {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 12px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            word-break: break-all;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            line-height: 1.5;
        }

        .ai-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 24px;
            position: relative;
            z-index: 2;
        }

        .btn-outline-white {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            backdrop-filter: blur(10px);
        }

        .btn-outline-white:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: white;
            transform: translateY(-2px);
        }

        .ai-sharing-tips {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            margin-top: 24px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .ai-sharing-tips h4 {
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-sharing-tips ul {
            list-style: none;
            padding: 0;
        }

        .ai-sharing-tips li {
            margin: 12px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            font-size: 14px;
            line-height: 1.6;
        }

        .ai-sharing-tips li i {
            margin-top: 2px;
            flex-shrink: 0;
        }

        /* Stats cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
            margin: 32px 0;
        }
        
        .stat-card {
            background: white;
            padding: 28px;
            border-radius: 16px;
            border: 1px solid var(--gray-200);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .stat-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 24px;
        }

        .stat-card:nth-child(1) .stat-icon {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
        }

        .stat-card:nth-child(2) .stat-icon {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .stat-card:nth-child(3) .stat-icon {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .stat-card:nth-child(4) .stat-icon {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .stat-card:nth-child(5) .stat-icon {
            background: rgba(139, 92, 246, 0.1);
            color: #8b5cf6;
        }

        .stat-card:nth-child(6) .stat-icon {
            background: rgba(6, 182, 212, 0.1);
            color: #06b6d4;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 8px;
            line-height: 1;
        }
        
        .stat-label {
            color: var(--gray-600);
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-change {
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        /* AI Test Interface */
        .ai-test {
            background: var(--gray-50);
            border-radius: 16px;
            padding: 32px;
            margin: 32px 0;
            border: 1px solid var(--gray-200);
        }

        .ai-test-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .ai-test h4 {
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0;
            font-size: 18px;
            font-weight: 700;
        }

        .ai-test-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ai-test-status.online {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }

        .ai-test-status.offline {
            background: rgba(156, 163, 175, 0.2);
            color: var(--gray-500);
        }

        .chat-container {
            background: white;
            border-radius: 12px;
            border: 1px solid var(--gray-200);
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            margin-bottom: 20px;
            font-size: 14px;
            scrollbar-width: thin;
            scrollbar-color: var(--gray-300) transparent;
        }

        .chat-container::-webkit-scrollbar {
            width: 6px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: 3px;
        }

        .chat-container::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }

        .chat-message {
            margin-bottom: 16px;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 85%;
            animation: messageSlideIn 0.3s ease-out;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-message.user {
            background: var(--gradient-primary);
            color: white;
            margin-left: auto;
            text-align: left;
            border-bottom-right-radius: 4px;
        }

        .chat-message.ai {
            background: var(--gray-100);
            color: var(--gray-900);
            border-bottom-left-radius: 4px;
        }

        .chat-message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 4px;
        }

        .chat-input-container {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .chat-input {
            flex: 1;
            padding: 14px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            font-size: 14px;
            resize: none;
            max-height: 100px;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        .chat-send-btn {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        /* Empty states */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--gray-600);
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 32px;
            color: var(--gray-400);
        }

        .empty-state h3 {
            margin-bottom: 8px;
            color: var(--gray-700);
            font-size: 18px;
            font-weight: 600;
        }

        .empty-state p {
            font-size: 14px;
            line-height: 1.6;
            max-width: 400px;
            margin: 0 auto;
        }

        /* Schedule/Hours interface */
        .schedule-grid {
            display: grid;
            gap: 20px;
            margin: 24px 0;
        }

        .schedule-day {
            padding: 24px;
            background: white;
            border-radius: 12px;
            border: 2px solid var(--gray-200);
            transition: all 0.2s ease;
        }

        .schedule-day:hover {
            border-color: var(--primary);
        }

        .schedule-day.disabled {
            opacity: 0.6;
            background: var(--gray-50);
        }

        .schedule-day-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .schedule-day-name {
            font-weight: 700;
            color: var(--gray-900);
            font-size: 16px;
        }

        .schedule-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .schedule-toggle input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }

        .schedule-toggle label {
            font-size: 14px;
            color: var(--gray-600);
            margin: 0;
        }

        .schedule-times {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-top: 12px;
        }

        .schedule-time-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .schedule-time-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .schedule-time-inputs {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .schedule-time-inputs input[type="time"] {
            padding: 8px 12px;
            border: 1px solid var(--gray-200);
            border-radius: 6px;
            font-size: 14px;
        }

        .schedule-time-separator {
            color: var(--gray-400);
            font-weight: 600;
        }

        /* Product/Service forms */
        .product-form {
            background: var(--gray-50);
            border-radius: 12px;
            padding: 32px;
            margin: 24px 0;
            border: 1px solid var(--gray-200);
        }

        .product-form h4 {
            margin-bottom: 24px;
            color: var(--gray-900);
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .product-form .form-row {
            margin-bottom: 24px;
        }

        .product-form .form-actions {
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: flex-end;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--gray-200);
        }

        /* Categories management */
        .categories-section {
            margin-bottom: 32px;
        }

        .category-input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .category-input-group input {
            flex: 1;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }
        
        .category-item {
            padding: 12px 16px;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 8px;
            text-align: center;
            position: relative;
            font-weight: 500;
            color: var(--primary);
            transition: all 0.2s ease;
        }

        .category-item:hover {
            background: rgba(99, 102, 241, 0.15);
        }
        
        .category-remove {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .category-remove:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow);
        }

        /* Progress completion */
        .completion-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--gray-600);
            margin-bottom: 20px;
        }

        .completion-bar {
            flex: 1;
            height: 8px;
            background: var(--gray-200);
            border-radius: 4px;
            overflow: hidden;
        }

        .completion-fill {
            height: 100%;
            background: var(--gradient-primary);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .completion-text {
            font-weight: 600;
            color: var(--primary);
            white-space: nowrap;
        }

        /* Responsive design */
        @media (max-width: 1200px) {
            .container {
                padding: 16px;
            }

            .tab-content {
                padding: 24px;
            }

            .plan-selector {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 12px 16px;
            }

            .logo h1 {
                font-size: 24px;
            }

            .logo-icon {
                width: 36px;
                height: 36px;
                font-size: 18px;
            }

            .user-details {
                display: none;
            }

            .progress-steps {
                flex-wrap: wrap;
                gap: 16px;
                justify-content: center;
            }

            .step {
                min-width: 60px;
            }

            .plan-selector {
                grid-template-columns: 1fr;
            }

            .ai-actions {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .schedule-times {
                grid-template-columns: 1fr;
            }

            .product-form {
                padding: 20px;
            }

            .tab-content {
                padding: 20px;
            }

            .btn-group {
                flex-direction: column;
                align-items: stretch;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .categories-grid {
                grid-template-columns: 1fr 1fr;
            }

            .ai-preview {
                padding: 20px;
            }

            .stat-card {
                padding: 20px;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --gray-50: #1f2937;
                --gray-100: #374151;
                --gray-200: #4b5563;
                --gray-300: #6b7280;
            }
        }

        /* Print styles */
        @media print {
            .header, .tab-nav, .btn, .ai-actions, .loading-overlay, .toast-container {
                display: none !important;
            }
            
            .main-content {
                box-shadow: none;
                border: 1px solid #ccc;
            }

            .tab-pane {
                display: block !important;
            }
        }

        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Focus indicators */
        .btn:focus-visible,
        input:focus-visible,
        textarea:focus-visible,
        select:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* Animation utilities */
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .slide-up {
            animation: slideUp 0.5s ease-out;
        }

        .bounce-in {
            animation: bounceIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                transform: translateY(30px); 
                opacity: 0; 
            }
            to { 
                transform: translateY(0); 
                opacity: 1; 
            }
        }

        @keyframes bounceIn {
            0% { 
                transform: scale(0.3); 
                opacity: 0; 
            }
            50% { 
                transform: scale(1.05); 
            }
            70% { 
                transform: scale(0.9); 
            }
            100% { 
                transform: scale(1); 
                opacity: 1; 
            }
        }
    </style>
</head>
<body>
    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div>
            <div class="spinner"></div>
            <div class="loading-text" id="loadingText">Cargando...</div>
        </div>
    </div>

    <!-- Toast container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="header">
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-robot"></i>
            </div>
            <h1>INDICEIA</h1>
        </div>
        <div class="user-info">
            <div class="user-avatar" id="userAvatar">U</div>
            <div class="user-details">
                <div class="user-name" id="userName">Usuario</div>
                <div class="user-email" id="userEmail">Cargando...</div>
            </div>
            <button class="btn-logout" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i> Salir
            </button>
        </div>
    </div>

    <div class="container">
        <!-- Progress indicator -->
        <div class="progress-indicator slide-up">
            <div class="progress-header">
                <div class="progress-title">Configuración de tu IA Comercial</div>
                <div class="progress-subtitle">Completa todos los pasos para tener tu asistente listo</div>
            </div>
            <div class="completion-indicator">
                <div class="completion-bar">
                    <div class="completion-fill" id="completionFill" style="width: 25%"></div>
                </div>
                <div class="completion-text" id="completionText">25% completado</div>
            </div>
            <div class="progress-steps">
                <div class="progress-line" id="progressLine" style="width: 25%"></div>
                <div class="step completed" data-step="comercio">
                    <div class="step-circle"><i class="fas fa-check"></i></div>
                    <div class="step-label">Comercio</div>
                </div>
                <div class="step active" data-step="productos">
                    <div class="step-circle">2</div>
                    <div class="step-label">Productos</div>
                </div>
                <div class="step" data-step="configuracion">
                    <div class="step-circle">3</div>
                    <div class="step-label">Configuración</div>
                </div>
                <div class="step" data-step="ia">
                    <div class="step-circle">4</div>
                    <div class="step-label">IA Lista</div>
                </div>
            </div>
        </div>

        <div class="main-content fade-in">
            <div class="tab-nav">
                <button class="tab-button active" data-tab="comercio">
                    <i class="fas fa-store"></i> Mi Comercio
                    <span class="tab-notification hidden" id="comercioNotif">!</span>
                </button>
                <button class="tab-button" data-tab="horarios">
                    <i class="fas fa-clock"></i> Horarios
                </button>
                <button class="tab-button" data-tab="productos">
                    <i class="fas fa-box"></i> Productos
                    <span class="tab-notification hidden" id="productosNotif">0</span>
                </button>
                <button class="tab-button" data-tab="servicios">
                    <i class="fas fa-cogs"></i> Servicios
                </button>
                <button class="tab-button" data-tab="delivery">
                    <i class="fas fa-truck"></i> Delivery
                </button>
                <button class="tab-button" data-tab="ia">
                    <i class="fas fa-robot"></i> Mi IA
                </button>
                <button class="tab-button" data-tab="estadisticas">
                    <i class="fas fa-chart-line"></i> Estadísticas
                </button>
            </div>

            <div class="tab-content">
                <!-- TAB: Mi Comercio -->
                <div class="tab-pane active" id="comercio">
                    <div class="form-section">
                        <h3><i class="fas fa-crown"></i> Elige tu Plan</h3>
                        <div class="form-section-subtitle">
                            Selecciona el plan que mejor se adapte a tu negocio. Puedes cambiar en cualquier momento.
                        </div>
                        <div class="plan-selector">
                            <div class="plan-card" data-plan="basic">
                                <h3>BASIC</h3>
                                <div class="plan-subtitle">Perfecto para empezar</div>
                                <div class="plan-price">
                                    <span class="currency">$</span>15<span class="period">/mes</span>
                                </div>
                                <ul class="plan-features">
                                    <li><i class="fas fa-check"></i> 50 productos máximo</li>
                                    <li><i class="fas fa-check"></i> IA básica de consultas</li>
                                    <li><i class="fas fa-check"></i> Soporte por email</li>
                                    <li><i class="fas fa-check"></i> Actualizaciones incluidas</li>
                                    <li class="not-included"><i class="fas fa-times"></i> Sin estadísticas avanzadas</li>
                                </ul>
                            </div>
                            <div class="plan-card" data-plan="mega">
                                <h3>MEGA</h3>
                                <div class="plan-subtitle">Sin límites</div>
                                <div class="plan-price">
                                    <span class="currency">$</span>75<span class="period">/mes</span>
                                </div>
                                <ul class="plan-features">
                                    <li><i class="fas fa-check"></i> Productos ilimitados</li>
                                    <li><i class="fas fa-check"></i> Todo incluido</li>
                                    <li><i class="fas fa-check"></i> Soporte 24/7</li>
                                    <li><i class="fas fa-check"></i> Múltiples ubicaciones</li>
                                    <li><i class="fas fa-check"></i> Marca blanca disponible</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <form id="comercioForm" novalidate>
                        <div class="form-section">
                            <h3><i class="fas fa-info-circle"></i> Información Básica</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="nombreComercio">Nombre del Comercio <span class="required">*</span></label>
                                    <input type="text" id="nombreComercio" name="nombreComercio" required 
                                           placeholder="Ej: Pastelería Dulce Vida">
                                    <div class="error-message">Este campo es obligatorio</div>
                                </div>
                                <div class="form-group">
                                    <label for="rubro">Rubro/Especialidad <span class="required">*</span></label>
                                    <select id="rubro" name="rubro" required>
                                        <option value="">Seleccionar rubro...</option>
                                        <option value="gastronomia">🍽️ Gastronomía</option>
                                        <option value="belleza">💄 Belleza y Estética</option>
                                        <option value="indumentaria">👕 Indumentaria</option>
                                        <option value="ferreteria">🔧 Ferretería</option>
                                        <option value="electrodomesticos">📱 Electrodomésticos</option>
                                        <option value="farmacia">💊 Farmacia</option>
                                        <option value="libreria">📚 Librería</option>
                                        <option value="deportes">⚽ Deportes</option>
                                        <option value="mascotas">🐕 Mascotas</option>
                                        <option value="hogar">🏠 Hogar y Decoración</option>
                                        <option value="servicios">⚙️ Servicios Profesionales</option>
                                        <option value="otro">❓ Otro</option>
                                    </select>
                                    <div class="error-message">Debes seleccionar un rubro</div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="direccion">Dirección <span class="optional">(opcional)</span></label>
                                    <input type="text" id="direccion" name="direccion" 
                                           placeholder="Ej: Av. San Martín 123">
                                </div>
                                <div class="form-group">
                                    <label for="localidad">Localidad <span class="optional">(opcional)</span></label>
                                    <input type="text" id="localidad" name="localidad" 
                                           placeholder="Ej: Rosario, Santa Fe">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="descripcion">Descripción del Negocio <span class="required">*</span></label>
                                <textarea id="descripcion" name="descripcion" required
                                          placeholder="Describe tu negocio, especialidades, qué lo hace único..."></textarea>
                                <div class="error-message">Agrega una descripción de tu negocio</div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3><i class="fas fa-phone"></i> Contacto</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="telefono">Teléfono <span class="optional">(opcional)</span></label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">📞</div>
                                        <input type="tel" id="telefono" name="telefono" 
                                               placeholder="341-123-4567">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="whatsapp">WhatsApp <span class="required">*</span></label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">📱</div>
                                        <input type="tel" id="whatsapp" name="whatsapp" required
                                               placeholder="+54 9 341 123-4567">
                                    </div>
                                    <div class="error-message">WhatsApp es necesario para derivar consultas</div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="email">Email <span class="optional">(opcional)</span></label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">📧</div>
                                        <input type="email" id="email" name="email" 
                                               placeholder="contacto@minegocio.com">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="website">Sitio Web <span class="optional">(opcional)</span></label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">🌐</div>
                                        <input type="url" id="website" name="website" 
                                               placeholder="https://minegocio.com">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3><i class="fab fa-instagram"></i> Redes Sociales</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="instagram">Instagram <span class="optional">(opcional)</span></label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">@</div>
                                        <input type="text" id="instagram" name="instagram" 
                                               placeholder="mi_negocio">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="facebook">Facebook <span class="optional">(opcional)</span></label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">📘</div>
                                        <input type="text" id="facebook" name="facebook" 
                                               placeholder="Mi Negocio">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3><i class="fas fa-credit-card"></i> Medios de Pago</h3>
                            <div class="form-section-subtitle">Selecciona todos los medios de pago que aceptas</div>
                            <div class="checkbox-grid">
                                <div class="checkbox-item">
                                    <input type="checkbox" name="mediosPago" value="efectivo" id="efectivo">
                                    <label for="efectivo"><i class="fas fa-money-bill"></i> Efectivo</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="mediosPago" value="tarjeta" id="tarjeta">
                                    <label for="tarjeta"><i class="fas fa-credit-card"></i> Tarjetas</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="mediosPago" value="transferencia" id="transferencia">
                                    <label for="transferencia"><i class="fas fa-university"></i> Transferencia</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="mediosPago" value="mercadopago" id="mercadopago">
                                    <label for="mercadopago"><i class="fas fa-mobile-alt"></i> Mercado Pago</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="mediosPago" value="uala" id="uala">
                                    <label for="uala"><i class="fas fa-circle"></i> Ualá</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" name="mediosPago" value="otros" id="otros">
                                    <label for="otros"><i class="fas fa-plus"></i> Otros</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3><i class="fas fa-clipboard-list"></i> Políticas del Negocio</h3>
                            <div class="form-group">
                                <label for="politicaDevolucion">Política de Devoluciones <span class="optional">(opcional)</span></label>
                                <textarea id="politicaDevolucion" name="politicaDevolucion" 
                                          placeholder="Ej: Devoluciones hasta 30 días con ticket de compra..."></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tiempoPreparacion">Tiempo de Preparación <span class="optional">(opcional)</span></label>
                                    <input type="text" id="tiempoPreparacion" name="tiempoPreparacion" 
                                           placeholder="Ej: 15-30 minutos">
                                </div>
                                <div class="form-group">
                                    <label for="descuentoCantidad">Descuentos por Cantidad <span class="optional">(opcional)</span></label>
                                    <input type="text" id="descuentoCantidad" name="descuentoCantidad" 
                                           placeholder="Ej: 10% en compras +$5000">
                                </div>
                            </div>
                        </div>

                        <div class="btn-group btn-group-end">
                            <button type="button" class="btn btn-secondary" id="resetForm">
                                <i class="fas fa-undo"></i> Limpiar
                            </button>
                            <button type="submit" class="btn btn-success btn-lg" id="saveComercio">
                                <i class="fas fa-save"></i> Guardar Información
                            </button>
                        </div>
                    </form>
                </div>

                <!-- TAB: Horarios -->
                <div class="tab-pane" id="horarios">
                    <div class="form-section">
                        <h3><i class="fas fa-clock"></i> Horarios de Atención</h3>
                        <div class="form-section-subtitle">
                            Configura los horarios para cada día. Puedes tener horario cortado (mañana y tarde)
                        </div>

                        <div class="schedule-grid">
                            <div class="schedule-day" data-day="lunes">
                                <div class="schedule-day-header">
                                    <div class="schedule-day-name">Lunes</div>
                                    <div class="schedule-toggle">
                                        <input type="checkbox" id="lunes_abierto" name="lunes_abierto" checked>
                                        <label for="lunes_abierto">Abierto</label>
                                    </div>
                                </div>
                                <div class="schedule-times">
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Mañana</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="lunes_manana_inicio" value="08:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="lunes_manana_fin" value="12:00">
                                        </div>
                                    </div>
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Tarde</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="lunes_tarde_inicio" value="16:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="lunes_tarde_fin" value="20:00">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="schedule-day" data-day="martes">
                                <div class="schedule-day-header">
                                    <div class="schedule-day-name">Martes</div>
                                    <div class="schedule-toggle">
                                        <input type="checkbox" id="martes_abierto" name="martes_abierto" checked>
                                        <label for="martes_abierto">Abierto</label>
                                    </div>
                                </div>
                                <div class="schedule-times">
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Mañana</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="martes_manana_inicio" value="08:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="martes_manana_fin" value="12:00">
                                        </div>
                                    </div>
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Tarde</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="martes_tarde_inicio" value="16:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="martes_tarde_fin" value="20:00">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="schedule-day" data-day="miercoles">
                                <div class="schedule-day-header">
                                    <div class="schedule-day-name">Miércoles</div>
                                    <div class="schedule-toggle">
                                        <input type="checkbox" id="miercoles_abierto" name="miercoles_abierto" checked>
                                        <label for="miercoles_abierto">Abierto</label>
                                    </div>
                                </div>
                                <div class="schedule-times">
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Mañana</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="miercoles_manana_inicio" value="08:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="miercoles_manana_fin" value="12:00">
                                        </div>
                                    </div>
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Tarde</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="miercoles_tarde_inicio" value="16:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="miercoles_tarde_fin" value="20:00">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="schedule-day" data-day="jueves">
                                <div class="schedule-day-header">
                                    <div class="schedule-day-name">Jueves</div>
                                    <div class="schedule-toggle">
                                        <input type="checkbox" id="jueves_abierto" name="jueves_abierto" checked>
                                        <label for="jueves_abierto">Abierto</label>
                                    </div>
                                </div>
                                <div class="schedule-times">
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Mañana</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="jueves_manana_inicio" value="08:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="jueves_manana_fin" value="12:00">
                                        </div>
                                    </div>
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Tarde</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="jueves_tarde_inicio" value="16:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="jueves_tarde_fin" value="20:00">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="schedule-day" data-day="viernes">
                                <div class="schedule-day-header">
                                    <div class="schedule-day-name">Viernes</div>
                                    <div class="schedule-toggle">
                                        <input type="checkbox" id="viernes_abierto" name="viernes_abierto" checked>
                                        <label for="viernes_abierto">Abierto</label>
                                    </div>
                                </div>
                                <div class="schedule-times">
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Mañana</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="viernes_manana_inicio" value="08:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="viernes_manana_fin" value="12:00">
                                        </div>
                                    </div>
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Tarde</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="viernes_tarde_inicio" value="16:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="viernes_tarde_fin" value="20:00">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="schedule-day" data-day="sabado">
                                <div class="schedule-day-header">
                                    <div class="schedule-day-name">Sábado</div>
                                    <div class="schedule-toggle">
                                        <input type="checkbox" id="sabado_abierto" name="sabado_abierto" checked>
                                        <label for="sabado_abierto">Abierto</label>
                                    </div>
                                </div>
                                <div class="schedule-times">
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Mañana</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="sabado_manana_inicio" value="09:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="sabado_manana_fin" value="13:00">
                                        </div>
                                    </div>
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Tarde</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="sabado_tarde_inicio" value="">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="sabado_tarde_fin" value="">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="schedule-day" data-day="domingo">
                                <div class="schedule-day-header">
                                    <div class="schedule-day-name">Domingo</div>
                                    <div class="schedule-toggle">
                                        <input type="checkbox" id="domingo_abierto" name="domingo_abierto">
                                        <label for="domingo_abierto">Abierto</label>
                                    </div>
                                </div>
                                <div class="schedule-times">
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Mañana</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="domingo_manana_inicio" value="10:00">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="domingo_manana_fin" value="14:00">
                                        </div>
                                    </div>
                                    <div class="schedule-time-group">
                                        <div class="schedule-time-label">Tarde</div>
                                        <div class="schedule-time-inputs">
                                            <input type="time" name="domingo_tarde_inicio" value="">
                                            <span class="schedule-time-separator">a</span>
                                            <input type="time" name="domingo_tarde_fin" value="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="btn-group btn-group-end">
                            <button type="button" class="btn btn-primary btn-lg" id="guardarHorarios">
                                <i class="fas fa-save"></i> Guardar Horarios
                            </button>
                        </div>
                    </div>
                </div>

                <!-- TAB: Productos -->
                <div class="tab-pane" id="productos">
                    <div class="form-section categories-section">
                        <h3><i class="fas fa-tags"></i> Categorías de Productos</h3>
                        <div class="form-section-subtitle">
                            Organiza tus productos en categorías para que sea más fácil encontrarlos
                        </div>
                        <div class="category-input-group">
                            <input type="text" id="nuevaCategoria" placeholder="Nueva categoría..." maxlength="30">
                            <button type="button" class="btn btn-success" id="agregarCategoria">
                                <i class="fas fa-plus"></i> Agregar
                            </button>
                        </div>
                        <div class="categories-grid" id="categoriasGrid">
                            <div class="category-item">
                                General
                                <button class="category-remove" onclick="removeCategoria(this)" title="Eliminar categoría">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-file-excel"></i> Carga Masiva de Productos</h3>
                        <div class="file-upload" id="fileUpload">
                            <div class="file-upload-content">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <h3>Cargar Excel de Productos</h3>
                                <p>Arrastra tu archivo Excel aquí o haz click para seleccionar</p>
                                <button type="button" class="btn btn-outline">
                                    <i class="fas fa-folder-open"></i> Seleccionar archivo
                                </button>
                            </div>
                            <div class="file-upload-success">
                                <i class="fas fa-check-circle" style="color: var(--success); font-size: 48px;"></i>
                                <h3>¡Archivo procesado!</h3>
                            </div>
                            <input type="file" id="excelFile" accept=".xlsx,.xls,.csv" style="display: none;">
                        </div>
                        <div class="file-format-info">
                            <i class="fas fa-info-circle"></i>
                            <div>
                                <strong>Formato requerido:</strong> Columnas A=Código, B=Nombre, C=Precio, D=Categoría, E=Stock, F=Descripción
                                <br>
                                <small>Formatos soportados: .xlsx, .xls, .csv</small>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-plus"></i> Agregar Producto Manual</h3>
                        <div class="product-form">
                            <h4><i class="fas fa-box"></i> Nuevo Producto</h4>
                            <form class="product-form-grid" id="productoForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="productoCodigo">Código <span class="required">*</span></label>
                                        <input type="text" name="codigo" id="productoCodigo" placeholder="SKU001" required>
                                        <div class="error-message">Código es obligatorio</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="productoNombre">Nombre <span class="required">*</span></label>
                                        <input type="text" name="nombre" id="productoNombre" placeholder="Nombre del producto" required>
                                        <div class="error-message">Nombre es obligatorio</div>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="productoCategoria">Categoría</label>
                                        <select name="categoria" id="productoCategoria">
                                            <option value="General">General</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="productoMarca">Marca <span class="optional">(opcional)</span></label>
                                        <input type="text" name="marca" id="productoMarca" placeholder="Marca del producto">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="productoPrecio">Precio <span class="required">*</span></label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">$</div>
                                            <input type="number" name="precio" id="productoPrecio" step="0.01" min="0" required>
                                        </div>
                                        <div class="error-message">Precio es obligatorio</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="productoStock">Stock <span class="optional">(opcional)</span></label>
                                        <input type="number" name="stock" id="productoStock" min="0" placeholder="Cantidad disponible">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="productoTalles">Talles <span class="optional">(opcional)</span></label>
                                        <input type="text" name="talles" id="productoTalles" placeholder="S,M,L,XL">
                                    </div>
                                    <div class="form-group">
                                        <label for="productoColores">Colores <span class="optional">(opcional)</span></label>
                                        <input type="text" name="colores" id="productoColores" placeholder="Rojo,Azul,Verde">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="productoImagen">URL Imagen <span class="optional">(opcional)</span></label>
                                    <input type="url" name="imagen" id="productoImagen" placeholder="https://ejemplo.com/imagen.jpg">
                                </div>
                                
                                <div class="form-group">
                                    <label for="productoDescripcion">Descripción <span class="optional">(opcional)</span></label>
                                    <textarea name="descripcion" id="productoDescripcion" placeholder="Descripción detallada del producto..."></textarea>
                                </div>
                                
                                <div class="form-actions">
                                    <div class="checkbox-grid" style="margin: 0; gap: 20px;">
                                        <div class="checkbox-item">
                                            <input type="checkbox" name="destacado" id="productoDestacado">
                                            <label for="productoDestacado"><i class="fas fa-star"></i> Producto Destacado</label>
                                        </div>
                                        <div class="checkbox-item">
                                            <input type="checkbox" name="activo" id="productoActivo" checked>
                                            <label for="productoActivo"><i class="fas fa-eye"></i> Activo</label>
                                        </div>
                                    </div>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-secondary" id="limpiarProducto">
                                            <i class="fas fa-eraser"></i> Limpiar
                                        </button>
                                        <button type="submit" class="btn btn-success">
                                            <i class="fas fa-plus"></i> Agregar Producto
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-list"></i> Lista de Productos</h3>
                        <div class="table-container" id="productosContainer">
                            <div class="table-header">
                                <div class="table-title">
                                    <i class="fas fa-box"></i> Productos Registrados
                                </div>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary" id="exportarProductos">
                                        <i class="fas fa-download"></i> Exportar
                                    </button>
                                    <button class="btn btn-sm btn-danger" id="limpiarProductos">
                                        <i class="fas fa-trash"></i> Limpiar Todo
                                    </button>
                                </div>
                            </div>
                            <table class="table" id="productosTable">
                                <thead>
                                    <tr>
                                        <th>Código</th>
                                        <th>Nombre</th>
                                        <th>Categoría</th>
                                        <th>Precio</th>
                                        <th>Stock</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="productsTableBody">
                                    <tr>
                                        <td colspan="7">
                                            <div class="empty-state">
                                                <div class="empty-state-icon">
                                                    <i class="fas fa-box-open"></i>
                                                </div>
                                                <h3>No hay productos cargados</h3>
                                                <p>Agrega productos manualmente o sube un Excel para comenzar</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- TAB: Servicios -->
                <div class="tab-pane" id="servicios">
                    <div class="form-section">
                        <h3><i class="fas fa-plus"></i> Agregar Servicio</h3>
                        <div class="product-form">
                            <h4><i class="fas fa-cogs"></i> Nuevo Servicio</h4>
                            <form class="product-form-grid" id="servicioForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="servicioNombre">Nombre del Servicio <span class="required">*</span></label>
                                        <input type="text" name="nombre" id="servicioNombre" placeholder="Consulta médica" required>
                                        <div class="error-message">Nombre es obligatorio</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="servicioCategoria">Categoría</label>
                                        <select name="categoria" id="servicioCategoria">
                                            <option value="consulta">Consulta</option>
                                            <option value="tratamiento">Tratamiento</option>
                                            <option value="mantenimiento">Mantenimiento</option>
                                            <option value="reparacion">Reparación</option>
                                            <option value="instalacion">Instalación</option>
                                            <option value="otro">Otro</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="servicioPrecio">Precio <span class="required">*</span></label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">$</div>
                                            <input type="number" name="precio" id="servicioPrecio" step="0.01" min="0" required>
                                        </div>
                                        <div class="error-message">Precio es obligatorio</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="servicioDuracion">Duración <span class="optional">(opcional)</span></label>
                                        <input type="text" name="duracion" id="servicioDuracion" placeholder="60 minutos">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="servicioModalidad">Modalidad</label>
                                        <select name="modalidad" id="servicioModalidad">
                                            <option value="presencial">Presencial</option>
                                            <option value="virtual">Virtual</option>
                                            <option value="ambas">Ambas</option>
                                            <option value="domicilio">A domicilio</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="servicioRequisitos">Requisitos <span class="optional">(opcional)</span></label>
                                        <input type="text" name="requisitos" id="servicioRequisitos" placeholder="Documento, edad mínima">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="servicioDescripcion">Descripción del servicio <span class="optional">(opcional)</span></label>
                                    <textarea name="descripcion" id="servicioDescripcion" placeholder="Descripción detallada del servicio..."></textarea>
                                </div>
                                
                                <div class="form-actions">
                                    <div class="checkbox-grid" style="margin: 0; gap: 20px;">
                                        <div class="checkbox-item">
                                            <input type="checkbox" name="destacado" id="servicioDestacado">
                                            <label for="servicioDestacado"><i class="fas fa-star"></i> Servicio Destacado</label>
                                        </div>
                                        <div class="checkbox-item">
                                            <input type="checkbox" name="activo" id="servicioActivo" checked>
                                            <label for="servicioActivo"><i class="fas fa-eye"></i> Activo</label>
                                        </div>
                                    </div>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-secondary" id="limpiarServicio">
                                            <i class="fas fa-eraser"></i> Limpiar
                                        </button>
                                        <button type="submit" class="btn btn-success">
                                            <i class="fas fa-plus"></i> Agregar Servicio
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-list"></i> Lista de Servicios</h3>
                        <div class="table-container" id="serviciosContainer">
                            <div class="table-header">
                                <div class="table-title">
                                    <i class="fas fa-cogs"></i> Servicios Registrados
                                </div>
                                <div class="table-actions">
                                    <button class="btn btn-sm btn-secondary" id="exportarServicios">
                                        <i class="fas fa-download"></i> Exportar
                                    </button>
                                    <button class="btn btn-sm btn-danger" id="limpiarServicios">
                                        <i class="fas fa-trash"></i> Limpiar Todo
                                    </button>
                                </div>
                            </div>
                            <table class="table" id="serviciosTable">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Categoría</th>
                                        <th>Precio</th>
                                        <th>Duración</th>
                                        <th>Modalidad</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="serviciosTableBody">
                                    <tr>
                                        <td colspan="7">
                                            <div class="empty-state">
                                                <div class="empty-state-icon">
                                                    <i class="fas fa-cogs"></i>
                                                </div>
                                                <h3>No hay servicios registrados</h3>
                                                <p>Agrega servicios usando el formulario anterior</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- TAB: Delivery -->
                <div class="tab-pane" id="delivery">
                    <div class="form-section">
                        <h3><i class="fas fa-truck"></i> Configuración de Delivery y Envíos</h3>
                        <div class="form-section-subtitle">
                            Configura las opciones de entrega y envío para tu negocio
                        </div>

                        <div class="checkbox-grid" style="margin-bottom: 32px;">
                            <div class="checkbox-item">
                                <input type="checkbox" id="tieneDelivery" name="tieneDelivery">
                                <label for="tieneDelivery"><i class="fas fa-truck"></i> Ofrecemos delivery/envíos</label>
                            </div>
                        </div>

                        <div id="deliveryConfig" class="hidden">
                            <div class="form-section">
                                <h3><i class="fas fa-cog"></i> Configuración de Delivery</h3>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="precioDelivery">Precio del Delivery</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">$</div>
                                            <input type="number" id="precioDelivery" name="precioDelivery" step="0.01" placeholder="300">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="tiempoDelivery">Tiempo de Entrega</label>
                                        <input type="text" id="tiempoDelivery" name="tiempoDelivery" placeholder="30-45 minutos">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="minimoDelivery">Mínimo para Delivery Gratis</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">$</div>
                                            <input type="number" id="minimoDelivery" name="minimoDelivery" step="0.01" placeholder="2000">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="radioCobertura">Radio de Cobertura</label>
                                        <input type="text" id="radioCobertura" name="radioCobertura" placeholder="5km del centro">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="zonasDelivery">Zonas de Delivery</label>
                                    <textarea id="zonasDelivery" name="zonasDelivery" placeholder="Centro, Barrio Norte, Villa María (recargo $100)..."></textarea>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3><i class="fas fa-shipping-fast"></i> Opciones de Envío</h3>
                                <div class="checkbox-grid">
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="metodosEnvio" value="retiro" id="retiro">
                                        <label for="retiro"><i class="fas fa-store"></i> Retiro en Local</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="metodosEnvio" value="delivery" id="deliveryPropio">
                                        <label for="deliveryPropio"><i class="fas fa-motorcycle"></i> Delivery Propio</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="metodosEnvio" value="correo" id="correoArgentino">
                                        <label for="correoArgentino"><i class="fas fa-envelope"></i> Correo Argentino</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="metodosEnvio" value="oca" id="oca">
                                        <label for="oca"><i class="fas fa-truck"></i> OCA</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="metodosEnvio" value="andreani" id="andreani">
                                        <label for="andreani"><i class="fas fa-box"></i> Andreani</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="metodosEnvio" value="mercadoenvios" id="mercadoEnvios">
                                        <label for="mercadoEnvios"><i class="fas fa-shipping-fast"></i> Mercado Envíos</label>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="politicaEnvio">Política de Envíos</label>
                                    <textarea id="politicaEnvio" name="politicaEnvio" placeholder="Envíos gratis en compras superiores a $2000. Entrega 24-48hs..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="btn-group btn-group-end">
                            <button type="button" class="btn btn-primary btn-lg" id="guardarDelivery">
                                <i class="fas fa-save"></i> Guardar Configuración
                            </button>
                        </div>
                    </div>
                </div>

                <!-- TAB: Mi IA -->
                <div class="tab-pane" id="ia">
                    <div class="form-section">
                        <h3><i class="fas fa-robot"></i> Configuración de tu IA</h3>
                        <div class="form-section-subtitle">
                            Personaliza cómo se comportará tu asistente de IA con los clientes
                        </div>

                        <form id="configIAForm" novalidate>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="nombreIA">Nombre de tu IA <span class="required">*</span></label>
                                    <input type="text" id="nombreIA" name="nombreIA" placeholder="Sofia IA" required>
                                    <div class="error-message">El nombre de la IA es obligatorio</div>
                                </div>
                                <div class="form-group">
                                    <label for="tonoIA">Personalidad/Tono</label>
                                    <select id="tonoIA" name="tonoIA">
                                        <option value="amigable">Amigable y cercano</option>
                                        <option value="profesional">Profesional</option>
                                        <option value="casual">Casual y relajado</option>
                                        <option value="elegante">Elegante y sofisticado</option>
                                        <option value="juvenil">Juvenil y moderno</option>
                                        <option value="tecnico">Técnico y preciso</option>
                                        <option value="divertido">Divertido y carismático</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="tonoPersonalizado">Tono Personalizado <span class="optional">(opcional)</span></label>
                                <input type="text" id="tonoPersonalizado" name="tonoPersonalizado" 
                                       placeholder="dulce y kawaii, rockero y rebelde, minimalista y zen">
                            </div>

                            <div class="form-group">
                                <label for="logoURL">URL del Logo <span class="optional">(opcional)</span></label>
                                <input type="url" id="logoURL" name="logoURL" placeholder="https://tu-logo.jpg">
                            </div>

                            <div class="form-group">
                                <label for="mensajeBienvenida">Mensaje de Bienvenida Personalizado</label>
                                <textarea id="mensajeBienvenida" name="mensajeBienvenida" 
                                          placeholder="¡Hola! Soy [NOMBRE_IA] y estoy aquí para ayudarte con todo lo que necesites..."></textarea>
                            </div>

                            <div class="form-group">
                                <label for="mensajeDespedida">Mensaje de Despedida</label>
                                <textarea id="mensajeDespedida" name="mensajeDespedida" 
                                          placeholder="¡Gracias por contactarnos! Que tengas un excelente día..."></textarea>
                            </div>

                            <div class="form-group">
                                <label for="emojisPreferidos">Emojis Preferidos <span class="optional">(opcional)</span></label>
                                <input type="text" id="emojisPreferidos" name="emojisPreferidos" 
                                       placeholder="🍰🥐🎂 para pastelería, 🔧⚙️🛠️ para ferretería">
                            </div>

                            <div class="form-section">
                                <h3><i class="fas fa-cogs"></i> Configuración Avanzada</h3>
                                <div class="checkbox-grid">
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="permisosIA" value="precios" id="precios" checked>
                                        <label for="precios"><i class="fas fa-dollar-sign"></i> Puede informar precios</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="permisosIA" value="stock" id="stock" checked>
                                        <label for="stock"><i class="fas fa-boxes"></i> Puede informar stock</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="permisosIA" value="derivar_contacto" id="derivarContacto" checked>
                                        <label for="derivarContacto"><i class="fas fa-phone"></i> Deriva contactos para ventas</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="permisosIA" value="recomendar" id="recomendar" checked>
                                        <label for="recomendar"><i class="fas fa-thumbs-up"></i> Puede recomendar productos</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="permisosIA" value="promociones" id="promociones" checked>
                                        <label for="promociones"><i class="fas fa-percentage"></i> Puede ofrecer promociones</label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" name="permisosIA" value="comparar" id="comparar" checked>
                                        <label for="comparar"><i class="fas fa-balance-scale"></i> Puede comparar productos</label>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="limiteDescuento">Límite de Descuento que Puede Ofrecer (%)</label>
                                        <input type="number" id="limiteDescuento" name="limiteDescuento" min="0" max="50" placeholder="15">
                                    </div>
                                    <div class="form-group">
                                        <label for="respuestasFueraHorario">Respuesta Fuera de Horario</label>
                                        <textarea id="respuestasFueraHorario" name="respuestasFueraHorario" 
                                                  placeholder="Estamos cerrados ahora, pero puedes escribirnos al WhatsApp..."></textarea>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="instruccionesEspeciales">Instrucciones Especiales para la IA</label>
                                    <textarea id="instruccionesEspeciales" name="instruccionesEspeciales" 
                                              placeholder="Siempre preguntar por la edad del cliente antes de recomendar productos..."></textarea>
                                </div>
                            </div>

                            <div class="btn-group btn-group-end">
                                <button type="button" class="btn btn-secondary" id="previewIA">
                                    <i class="fas fa-eye"></i> Vista Previa
                                </button>
                                <button type="submit" class="btn btn-success btn-lg" id="generarIA">
                                    <i class="fas fa-magic"></i> Generar Mi IA
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- AI Preview/Result -->
                    <div class="ai-preview hidden" id="aiPreviewSection">
                        <div class="ai-preview-header">
                            <i class="fas fa-check-circle"></i>
                            <h3>¡Tu IA está lista!</h3>
                        </div>
                        <div class="ai-preview-content">
                            <p><strong>Comparte este link con tus clientes:</strong></p>
                            <div class="ai-link-display" id="aiLinkDisplay">
                                https://chat.openai.com/?q=...
                            </div>
                            
                            <div class="ai-actions">
                                <button class="btn btn-outline-white" id="copyLinkBtn">
                                    <i class="fas fa-copy"></i> Copiar Link
                                </button>
                                <button class="btn btn-outline-white" id="testAIBtn">
                                    <i class="fas fa-play"></i> Probar IA
                                </button>
                                <button class="btn btn-outline-white" id="shareAIBtn">
                                    <i class="fas fa-share"></i> Compartir
                                </button>
                            </div>

                            <div class="ai-sharing-tips">
                                <h4><i class="fas fa-lightbulb"></i> ¿Cómo compartirlo?</h4>
                                <ul>
                                    <li><i class="fab fa-instagram"></i> <strong>Instagram Stories:</strong> Pega el link con texto "¡Pregúntale a nuestra IA!"</li>
                                    <li><i class="fab fa-whatsapp"></i> <strong>WhatsApp Estado:</strong> Comparte como "Consultas 24/7 con nuestra IA"</li>
                                    <li><i class="fab fa-facebook"></i> <strong>Facebook:</strong> Post con "Atención inteligente las 24 horas"</li>
                                    <li><i class="fas fa-globe"></i> <strong>Página Web:</strong> Botón "Chat con IA" que abra el link</li>
                                    <li><i class="fab fa-google"></i> <strong>Google My Business:</strong> En la descripción del negocio</li>
                                </ul>
                                
                                <div style="background: rgba(255, 255, 255, 0.1); padding: 16px; border-radius: 8px; margin-top: 16px;">
                                    <h4><i class="fas fa-quote-left"></i> Texto sugerido para redes:</h4>
                                    <p style="font-style: italic; margin: 8px 0;" id="textoCompartir">
                                        "🤖 ¡Ahora tenemos atención con IA las 24 horas! Consultá precios, stock, horarios y más. ¡Probala aquí! 👆"
                                    </p>
                                    <button class="btn btn-outline-white btn-sm" id="copyTextoBtn">
                                        <i class="fas fa-copy"></i> Copiar Texto
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI Test Interface -->
                    <div class="ai-test hidden" id="aiTestSection">
                        <div class="ai-test-header">
                            <h4><i class="fas fa-vial"></i> Probador de IA</h4>
                            <div class="ai-test-status online">
                                <i class="fas fa-circle"></i> Online
                            </div>
                        </div>
                        <div class="chat-container" id="chatContainer">
                            <div class="chat-message ai">
                                ¡Hola! Soy tu IA de prueba. ¿En qué te puedo ayudar?
                                <div class="chat-message-time">Ahora</div>
                            </div>
                        </div>
                        <div class="chat-input-container">
                            <textarea class="chat-input" id="chatInput" placeholder="Escribe tu mensaje..." rows="1"></textarea>
                            <button class="btn btn-primary chat-send-btn" id="chatSendBtn">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>

                    <!-- No IA message -->
                    <div id="noIAMessage">
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h3>IA no generada</h3>
                            <p>Completa la información del comercio y agrega algunos productos/servicios para generar tu IA</p>
                        </div>
                    </div>
                </div>

                <!-- TAB: Estadísticas -->
                <div class="tab-pane" id="estadisticas">
                    <div class="form-section">
                        <h3><i class="fas fa-chart-line"></i> Estadísticas de Tu IA</h3>
                        <div class="form-section-subtitle">
                            Monitorea el rendimiento de tu asistente inteligente
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <div class="stat-value" id="totalConsultas">247</div>
                                <div class="stat-label">Consultas Totales</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i> +12% vs mes pasado
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-calendar-day"></i>
                                </div>
                                <div class="stat-value" id="consultasHoy">23</div>
                                <div class="stat-label">Consultas Hoy</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i> +5 vs ayer
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="stat-value" id="productoMasConsultado">Pan Dulce</div>
                                <div class="stat-label">Producto + Consultado</div>
                                <div class="stat-change">
                                    <i class="fas fa-eye"></i> 45 consultas
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-percentage"></i>
                                </div>
                                <div class="stat-value" id="conversionRate">68%</div>
                                <div class="stat-label">Tasa de Conversión</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-arrow-up"></i> +3% esta semana
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="stat-value" id="horasPico">14-16h</div>
                                <div class="stat-label">Horario Pico</div>
                                <div class="stat-change">
                                    <i class="fas fa-users"></i> Mayor actividad
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-smile"></i>
                                </div>
                                <div class="stat-value" id="satisfaccion">4.8</div>
                                <div class="stat-label">Satisfacción Promedio</div>
                                <div class="stat-change positive">
                                    <i class="fas fa-star"></i>
                            </div>
                            <div class="plan-card popular selected" data-plan="extended">
                                <h3>EXTENDED</h3>
                                <div class="plan-subtitle">El más elegido</div>
                                <div class="plan-price">
                                    <span class="currency">$</span>25<span class="period">/mes</span>
                                </div>
                                <ul class="plan-features">
                                    <li><i class="fas fa-check"></i> 100 productos máximo</li>
                                    <li><i class="fas fa-check"></i> IA + Estadísticas completas</li>
                                    <li><i class="fas fa-check"></i> Soporte prioritario</li>
                                    <li><i class="fas fa-check"></i> Personalización avanzada</li>
                                    <li><i class="fas fa-check"></i> Reportes semanales</li>
                                </ul>
                            </div>
                            <div class="plan-card" data-plan="pro">
                                <h3>PRO</h3>
                                <div class="plan-subtitle">Para negocios grandes</div>
                                <div class="plan-price">
                                    <span class="currency">$</span>50<span class="period">/mes</span>
                                </div>
                                <ul class="plan-features">
                                    <li><i class="fas fa-check"></i> 1000 productos máximo</li>
                                    <li><i class="fas fa-check"></i> IA avanzada con aprendizaje</li>
                                    <li><i class="fas fa-check"></i> Integraciones futuras</li>
                                    <li><i class="fas fa-check"></i> API personalizada</li>
                                    <li><i class="fas fa-check"></i> Consultor dedicado</li>
                                </ul>
