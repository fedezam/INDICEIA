// shared.js - Funciones comunes extraÃ­das del cÃ³digo existente
import { auth, db, provider } from "./firebase.js";
import { 
  doc, setDoc, getDoc, collection, getDocs, addDoc, updateDoc, deleteDoc 
} from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

// ==========================================
// ðŸ”§ UTILS CLASE (Ya funcionando)
// ==========================================
class Utils {
  static showForm(title, fields, onSubmit) {
    const container = document.createElement("div");
    container.className =
      "fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50";

    const form = document.createElement("form");
    form.className =
      "bg-white shadow-lg rounded-xl w-full max-w-md p-6 flex flex-col space-y-4 animate-fade-in";

    const header = document.createElement("h2");
    header.textContent = title;
    header.className = "text-xl font-semibold text-center mb-2 text-gray-700";

    form.appendChild(header);

    fields.forEach((field) => {
      const wrapper = document.createElement("div");
      wrapper.className = "flex flex-col space-y-1";

      const label = document.createElement("label");
      label.textContent = field.label;
      label.className = "text-sm text-gray-600 font-medium";

      const input = document.createElement("input");
      input.type = field.type || "text";
      input.placeholder = field.placeholder || "";
      input.className =
        "border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700";

      wrapper.appendChild(label);
      wrapper.appendChild(input);
      form.appendChild(wrapper);
      field.input = input;
    });

    const button = document.createElement("button");
    button.type = "submit";
    button.textContent = "Aceptar";
    button.className =
      "bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition font-medium";

    form.appendChild(button);
    container.appendChild(form);
    document.body.appendChild(container);

    form.onsubmit = (e) => {
      e.preventDefault();
      const values = {};
      fields.forEach((field) => (values[field.name] = field.input.value));
      onSubmit(values);
      document.body.removeChild(container);
    };
  }

  static showLoading(message = "Cargando...") {
    const overlay = document.createElement("div");
    overlay.className =
      "fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50";

    const box = document.createElement("div");
    box.className =
      "bg-white px-6 py-4 rounded-xl shadow-lg flex items-center space-x-3 animate-pulse";

    const spinner = document.createElement("div");
    spinner.className =
      "w-5 h-5 border-4 border-blue-500 border-t-transparent rounded-full animate-spin";

    const text = document.createElement("span");
    text.textContent = message;
    text.className = "text-gray-700 font-medium";

    box.appendChild(spinner);
    box.appendChild(text);
    overlay.appendChild(box);
    document.body.appendChild(overlay);

    return () => {
      document.body.removeChild(overlay);
    };
  }
}

export { Utils };
